{"version":3,"sources":["../../../../assets/Script/assets/Script/game.js"],"names":["V","require","Emitter","cc","Class","extends","Component","properties","btnNewGame","Button","onLoad","instance","registerEvent","transBlocksLayout","transBlock","transScore","transBestScore","transAudio","initEvent","bind","onDisabledKeyDown","game","init","bestScore","loadBestScore","systemEvent","on","SystemEvent","EventType","KEY_DOWN","onKeyDown","node","event","startPoint","getLocation","TouchEnd","data","audio1","isNoneSound","isNoneMusic","blocksLayout","block","score","endPoint","subVector","sub","delta","mag","isCompleted","Math","abs","x","y","playSoundClick","inputRight","isMoved","inputLeft","log","inputUp","inputDown","console","keyCode","macro","KEY","down","up","left","right","off","start","update","dt"],"mappings":"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","file":"game.js","sourceRoot":"../../../../assets/Script","sourcesContent":["const V = require(\"Variables\");\nconst Emitter = require('mEmitter');\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        btnNewGame:cc.Button\n    },\n\n    onLoad: function () {\n        // Emitter.instance = new Emitter();\n        // Emitter.instance.emit('transGame', this);\n        Emitter.instance.registerEvent(\"transBlocksLayout\", this.transBlocksLayout, this);\n        Emitter.instance.registerEvent(\"transBlock\", this.transBlock, this);\n        Emitter.instance.registerEvent(\"transScore\", this.transScore, this);\n        Emitter.instance.registerEvent(\"transBestScore\", this.transBestScore, this);\n        Emitter.instance.registerEvent(\"transAudio\", this.transAudio, this);\n        Emitter.instance.registerEvent(\"onEnableKeyDown\", this.initEvent.bind(this));\n\n        // Emitter.instance.registerEvent(\"transAudioSceneWelcomeToMain\", this.transAudioSceneWelcomeToMain, this);\n        Emitter.instance.registerEvent(\"onDisabledKeyDown\", this.onDisabledKeyDown.bind(this));\n        Emitter.instance.registerEvent(\"onDisableKeyDownLoseGame\", this.onDisabledKeyDown.bind(this));\n        V.game = this.btnNewGame\n        this.initEvent();\n    },\n    init() {\n        V.bestScore.loadBestScore()\n    },\n    initEvent() {\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\n        this.node.on('touchstart', (event) => {\n            this.startPoint = event.getLocation()\n        })\n        this.node.on('touchend', (event) => {\n            this.TouchEnd(event);\n        })\n    },\n    // transAudioSceneWelcomeToMain(data) {\n    //     console.log(data);\n    // },\n    transAudio(data) {\n        V.audio1 = data\n        V.audio1.isNoneSound = V.isNoneSound\n        V.audio1.isNoneMusic = V.isNoneMusic\n    },\n    transBestScore(data) {\n        V.bestScore = data\n    },\n    transBlocksLayout(data) {\n        V.blocksLayout = data\n    },\n    transBlock(data) {\n        V.block = data\n    },\n    transScore(data) {\n        V.score = data\n    },\n    TouchEnd(event) {\n        this.endPoint = event.getLocation();\n        let subVector = this.endPoint.sub(this.startPoint);\n        let delta = subVector.mag();\n        if (V.isCompleted == true) {\n            if (delta > 50) {\n                if (Math.abs(subVector.x) > Math.abs(subVector.y)) {\n                    if (subVector.x > 0) {\n                        V.isCompleted = false\n                        V.audio1.playSoundClick()\n                        V.blocksLayout.inputRight()\n                        V.isMoved = false\n                    } else {\n                        V.isCompleted = false\n                        V.audio1.playSoundClick()\n                        V.blocksLayout.inputLeft()\n                        V.isMoved = false\n                    }\n                } else {\n                    if (subVector.y > 0) {\n                        V.isCompleted = false\n                        cc.log(\"up\");\n                        V.audio1.playSoundClick()\n                        V.blocksLayout.inputUp()\n                        V.isMoved = false\n                    } else {\n                        V.isCompleted = false\n                        V.audio1.playSoundClick()\n                        V.blocksLayout.inputDown()\n                        V.isMoved = false\n                    }\n                }\n            }\n        }\n        else{\n            return\n        }\n\n        \n    },\n\n\n    onKeyDown: function (event) {\n        if (V.isCompleted == false) {\n            console.log(\"not Completed\");\n            return\n        }\n        V.isCompleted = false\n        switch (event.keyCode) {\n            case cc.macro.KEY.down:\n                V.audio1.playSoundClick()\n                V.blocksLayout.inputDown()\n                V.isMoved = false\n                break;\n            case cc.macro.KEY.up:\n                V.audio1.playSoundClick()\n                V.blocksLayout.inputUp()\n                V.isMoved = false\n                break;\n            case cc.macro.KEY.left:\n                V.audio1.playSoundClick()\n                V.blocksLayout.inputLeft()\n                V.isMoved = false\n                break;\n            case cc.macro.KEY.right:\n                V.audio1.playSoundClick()\n                V.blocksLayout.inputRight()\n                V.isMoved = false\n                break;\n            default: {\n                V.isCompleted = true\n                return\n            }\n        }\n    },\n    onDisabledKeyDown() {\n        cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\n        this.node.off('touchstart');\n        this.node.off('touchend');\n    },\n    // called every frame\n    start() {\n        V.bestScore.loadBestScore()\n    },\n    update: function (dt) {\n\n    },\n});\n"]}